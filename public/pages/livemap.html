<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Map</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
        nav {
            position: relative;
            z-index: 2000;
        }
        #map {
            width: 100%;
            height: 100vh;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }
        .header-overlay {
            position: absolute;
            top: 80px;
            left: 0;
            right: 0;
            z-index: 1000;
            background: white;
            border-bottom: 1px solid #e5e7eb;
        }
        .button-overlay {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
   <nav class="bg-white border-b border-gray-200 shadow-sm">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-20">

      <!-- Logo -->
      <div class="flex-shrink-0">
        <img src="../assets/images/samway.png" alt="SameWay Logo" class="h-16 w-auto">
      </div>

      <!-- Desktop Links -->
      <div class="hidden md:flex items-center space-x-8">
       <a href="../index.html" class="text-gray-700 hover:text-[#003d6b] text-lg font-medium">Home</a>
        <a href="../pages/livemap.html"class="text-gray-700 hover:text-[#003d6b] text-lg font-medium">Find a Ride</a>
        <a href="#" class="text-gray-700 hover:text-[#003d6b] text-lg font-medium">Support</a>
      </div>

      <!-- Right side -->
      <div class="flex items-center gap-4">

        <!-- Search (desktop) -->
        <div class="hidden sm:block relative">
          <input
            type="text"
            placeholder="Search..."
            class="pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-[#003d6b]"
            style="min-width:250px"
          >
        </div>

        <!-- Avatar -->
        <img src="../assets/images/avatar.png"
             alt="User Avatar"
             class="w-12 h-12 rounded-full cursor-pointer">

        <!-- Mobile Menu -->
        <details class="md:hidden relative">
          <summary class="list-none cursor-pointer p-2 rounded-lg hover:bg-gray-100">
            <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </summary>

          <div class="absolute right-0 mt-4 w-56 bg-white border rounded-lg shadow-md p-4 space-y-3">
            <a href="../index.html" class="block text-gray-700">Home</a>
            <a href="../pages/livemap.html" class="block text-gray-700">Find a Ride</a>
            <a href="#" class="block text-gray-700">Support</a>

            <input
              type="text"
              placeholder="Search..."
              class="w-full mt-2 px-3 py-2 border rounded-lg bg-gray-50"
            >
          </div>
        </details>

      </div>
    </div>
  </div>
</nav>

    <!-- Map Container -->
    <div id="map"></div>

    <!-- Header overlay -->
    <div class="header-overlay">
        <div class="py-4 md:py-5">
            <h1 class="text-[#003d6b] text-3xl md:text-4xl font-bold text-center">LIVE MAP</h1>
        </div>
    </div>

    <!-- Button overlay -->
  <div class="button-overlay">
    <a href="../pages/recherchedutrajet.html"
       class="bg-[#003d6b] hover:bg-[#002d4f] text-white px-8 md:px-12 py-3 md:py-4 
              rounded-lg text-base md:text-lg font-semibold transition-colors shadow-xl 
              inline-block text-center">
        Search for a ride
    </a>
</div>


    <script>
        // Initialize map - centered on Tunis, Tunisia
        const map = L.map('map', {
            zoomControl: true,
            scrollWheelZoom: true,
            dragging: true
        }).setView([36.9020, 10.1870], 14);

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        // ESPRIT Engineering School marker (red pin)
        const espritIcon = L.divIcon({
            className: 'custom-destination-icon',
            html: `
                <div style="position: relative; width: 40px; height: 50px;">
                    <svg width="40" height="50" viewBox="0 0 40 50">
                        <path d="M20 0C11.2 0 4 7.2 4 16c0 12 16 34 16 34s16-22 16-34c0-8.8-7.2-16-16-16z" fill="#e53e3e"/>
                        <circle cx="20" cy="16" r="8" fill="white"/>
                    </svg>
                    <div style="position: absolute; top: 52px; left: 50%; transform: translateX(-50%); white-space: nowrap; background: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600; color: #e53e3e; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                        ESPRIT<br><span style="font-size: 10px; font-weight: normal;">engineering school</span>
                    </div>
                </div>
            `,
            iconSize: [40, 50],
            iconAnchor: [20, 50]
        });
        
        const espritPos = [36.8983, 10.1900];
        L.marker(espritPos, { icon: espritIcon }).addTo(map);

        // User location marker with "you're here" label - combined in one icon
        const userLocation = [36.9000, 10.1880];
        
        // Create custom icon with label and circles
        const userIcon = L.divIcon({
            className: 'custom-user-icon',
            html: `
                <div style="position: relative; width: 160px; height: 160px;">
                    <!-- Label -->
                    <div style="position: absolute; top: 0; left: 50%; transform: translateX(-50%); z-index: 10;">
                        <div style="background: white; padding: 6px 12px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); font-size: 14px; font-weight: 500; color: #003d6b; white-space: nowrap; margin-bottom: 4px;">
                            you're here
                        </div>
                        <div style="width: 0; height: 0; border-left: 8px solid transparent; border-right: 8px solid transparent; border-top: 8px solid white; margin: 0 auto;"></div>
                    </div>
                    <!-- Pulsing outer circle -->
                    <div id="pulseCircle" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 160px; height: 160px; border-radius: 50%; background: rgba(0, 61, 107, 0.2); border: 2px solid #003d6b;"></div>
                    <!-- Middle circle -->
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80px; height: 80px; border-radius: 50%; background: rgba(0, 61, 107, 0.8); border: 4px solid white;"></div>
                    <!-- Inner dot -->
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 30px; height: 30px; border-radius: 50%; background: #003d6b;"></div>
                </div>
            `,
            iconSize: [160, 160],
            iconAnchor: [80, 80]
        });
        
        L.marker(userLocation, { 
            icon: userIcon,
            interactive: false
        }).addTo(map);

        // Animate pulse effect with JavaScript
        let pulseSize = 160;
        let growing = false;
        setInterval(() => {
            const pulseElement = document.getElementById('pulseCircle');
            if (pulseElement) {
                if (growing) {
                    pulseSize += 2;
                    if (pulseSize >= 180) growing = false;
                } else {
                    pulseSize -= 2;
                    if (pulseSize <= 160) growing = true;
                }
                pulseElement.style.width = pulseSize + 'px';
                pulseElement.style.height = pulseSize + 'px';
            }
        }, 50);

        // Fit map to show all markers with padding
        const bounds = L.latLngBounds([userLocation, espritPos]);
        map.fitBounds(bounds, { padding: [150, 150] });
    </script>
</body>
</html>