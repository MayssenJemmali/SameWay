<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conducteur en route</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
        nav {
            position: relative;
            z-index: 2000;
        }
        #map {
            width: 100%;
            height: 100vh;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }
        .header-overlay {
            position: absolute;
            top: 80px;
            left: 0;
            right: 0;
            z-index: 1000;
            background: white;
            border-bottom: 1px solid #e5e7eb;
        }
        .driver-card-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 1rem;
            pointer-events: none;
        }
        .driver-card-overlay > div {
            pointer-events: auto;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
   <nav class="bg-white border-b border-gray-200 shadow-sm">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-20">

      <!-- Logo -->
      <div class="flex-shrink-0">
        <img src="../assets/images/samway.png" alt="SameWay Logo" class="h-16 w-auto">
      </div>

      <!-- Desktop Links -->
      <div class="hidden md:flex items-center space-x-8">
       <a href="../index.html" class="text-gray-700 hover:text-[#003d6b] text-lg font-medium">Home</a>
        <a href="../pages/livemap.html"class="text-gray-700 hover:text-[#003d6b] text-lg font-medium">Find a Ride</a>
        <a href="#" class="text-gray-700 hover:text-[#003d6b] text-lg font-medium">Support</a>
      </div>

      <!-- Right side -->
      <div class="flex items-center gap-4">

        <!-- Search (desktop) -->
        <div class="hidden sm:block relative">
          <input
            type="text"
            placeholder="Search..."
            class="pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-[#003d6b]"
            style="min-width:250px"
          >
        </div>

        <!-- Avatar -->
        <img src="../assets/images/avatar.png"
             alt="User Avatar"
             class="w-12 h-12 rounded-full cursor-pointer">

        <!-- Mobile Menu -->
        <details class="md:hidden relative">
          <summary class="list-none cursor-pointer p-2 rounded-lg hover:bg-gray-100">
            <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </summary>

          <div class="absolute right-0 mt-4 w-56 bg-white border rounded-lg shadow-md p-4 space-y-3">
            <a href="../index.html" class="block text-gray-700">Home</a>
            <a href="../pages/livemap.html" class="block text-gray-700">Find a Ride</a>
            <a href="#" class="block text-gray-700">Support</a>

            <input
              type="text"
              placeholder="Search..."
              class="w-full mt-2 px-3 py-2 border rounded-lg bg-gray-50"
            >
          </div>
        </details>

      </div>
    </div>
  </div>
</nav>
    <div id="map"></div>

    <!-- Header overlay -->
    <div class="header-overlay">
        <div class="py-4 md:py-5">
            <h1 class="text-[#003d6b] text-3xl md:text-4xl font-bold text-center">Driver on the way</h1>
        </div>
    </div>

    <!-- Driver Card overlay - floating on top of map -->
    <div class="driver-card-overlay">
        <div class="max-w-2xl mx-auto">
            <a href="../pages/CourseEnRoute.html" class="bg-[#c8e6f5] rounded-2xl px-6 md:px-8 py-5 md:py-6 flex items-center gap-4 md:gap-6 shadow-lg hover:bg-[#b9dcef] transition-colors">
                <img src="../assets/images/avatar.png" alt="Avatar Adem" class="w-16 h-16 md:w-20 md:h-20 rounded-full object-cover flex-shrink-0">
                
                <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-3 mb-1 justify-between">
                        <h3 class="text-xl md:text-2xl font-semibold text-gray-800">Adem</h3>
                        <div class="bg-[#003d6b] text-white px-2.5 py-1 rounded-full flex items-center gap-1 text-sm flex-shrink-0">
                            <span>★</span>
                            <span class="font-semibold">4.8</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-gray-600 text-sm md:text-base">
                        <span>Hyundai i10</span>
                        <span class="text-gray-500">Arrives in <span class="font-semibold text-gray-700">1min</span></span>
                    </div>
                </div>
            </a>
        </div>
    </div>

    <script>
        // Initialize map - centered on Tunis, Tunisia
        const map = L.map('map', {
            zoomControl: true,
            scrollWheelZoom: true,
            dragging: true
        }).setView([36.9020, 10.1870], 14);

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        // Destination marker (ESPRIT Engineering School)
        const destinationIcon = L.divIcon({
            className: 'custom-destination-icon',
            html: `
                <div style="position: relative; width: 40px; height: 50px;">
                    <svg width="40" height="50" viewBox="0 0 40 50">
                        <path d="M20 0C11.2 0 4 7.2 4 16c0 12 16 34 16 34s16-22 16-34c0-8.8-7.2-16-16-16z" fill="#e53e3e"/>
                        <circle cx="20" cy="16" r="8" fill="white"/>
                    </svg>
                    <div style="position: absolute; top: 52px; left: 50%; transform: translateX(-50%); white-space: nowrap; background: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; font-weight: 600; color: #e53e3e; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">ESPRIT<br><span style="font-size: 10px; font-weight: normal;">engineering school</span></div>
                </div>
            `,
            iconSize: [40, 50],
            iconAnchor: [20, 50]
        });
        
        const destinationPos = [36.8983, 10.1900];
        const destination = L.marker(destinationPos, { icon: destinationIcon }).addTo(map);

        // User location marker (blue circle with white border)
        const userLocation = [36.9000, 10.1880];
        const userCircle = L.circle(userLocation, {
            color: 'white',
            fillColor: '#4299e1',
            fillOpacity: 0.6,
            radius: 50,
            weight: 3
        }).addTo(map);

        // Inner dot for user location
        L.circle(userLocation, {
            color: '#003d6b',
            fillColor: '#003d6b',
            fillOpacity: 1,
            radius: 15,
            weight: 0
        }).addTo(map);

        // Car icon for driver
        const carIcon = L.divIcon({
            className: 'custom-car-icon',
            html: `
                <div style="background: #1a202c; border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; box-shadow: 0 3px 10px rgba(0,0,0,0.4);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="white">
                        <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
                    </svg>
                </div>
            `,
            iconSize: [36, 36],
            iconAnchor: [18, 18]
        });

        const driverLocation = [36.9080, 10.1820];
        const driver = L.marker(driverLocation, { icon: carIcon }).addTo(map);

        // Draw simple curved dotted route line from car to user location
        const routePath = [
            driverLocation,
            [36.9070, 10.1835],
            [36.9050, 10.1855],
            [36.9030, 10.1870],
            userLocation
        ];

        L.polyline(routePath, {
            color: '#003d6b',
            weight: 3,
            dashArray: '8, 12',
            opacity: 1,
            lineCap: 'round'
        }).addTo(map);

        // Fit map to show all markers with padding
        const bounds = L.latLngBounds([driverLocation, userLocation, destinationPos]);
        map.fitBounds(bounds, { padding: [100, 100] });
    </script>
</body>
</html>